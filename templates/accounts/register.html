{% extends 'base.html' %}
{% load static %}

{% block title %}Đăng ký - JobNow{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/accounts.css' %}">
{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card auth-card-wide">
        <div class="auth-title">
            <h2>Tạo tài khoản</h2>
            <p>Tham gia cùng hàng nghìn người tìm việc và nhà tuyển dụng ngay hôm nay.</p>
        </div>

        {% if messages %}
            {% for message in messages %}
            <div class="error-messages">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        <form method="POST" action="{% url 'accounts:register' %}" class="auth-form">
            {% csrf_token %}

            <div class="role-selection">
                <div class="role-selection-title">Tôi là... *</div>
                
                {% if not request.POST.role %}
                    <div class="role-required">Vui lòng chọn loại tài khoản</div>
                {% endif %}

                <div class="role-options">
                    <div class="role-option">
                        <input type="radio" id="candidate" name="role" value="candidate" required 
                            {% if request.POST.role == 'candidate' %}checked{% endif %}>
                        <label for="candidate">
                            <div class="role-icon"><i class="fa-solid fa-user"></i></div>
                            <div class="role-name">Người tìm việc</div>
                            <div class="role-description">Đang tìm kiếm cơ hội việc làm</div>
                        </label>
                    </div>

                    <div class="role-option">
                        <input type="radio" id="employer" name="role" value="employer" required
                            {% if request.POST.role == 'employer' %}checked{% endif %}>
                        <label for="employer">
                            <div class="role-icon"><i class="fa-solid fa-building"></i></div>
                            <div class="role-name">Nhà tuyển dụng</div>
                            <div class="role-description">Tuyển dụng cho công ty của bạn</div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="id_first_name">Họ và tên *</label>
                <input 
                    type="text" 
                    id="id_first_name" 
                    name="first_name"
                    placeholder="Nguyễn Văn A"
                    required
                    value="{{ request.POST.first_name|default:'' }}"
                >
            </div>

            <div class="form-group">
                <label for="id_email">Địa chỉ email *</label>
                <input 
                    type="email" 
                    id="id_email" 
                    name="email"
                    placeholder="name@example.com"
                    required
                    value="{{ request.POST.email|default:'' }}"
                >
            </div>

            <div class="form-group">
                <label for="id_username">Tên đăng nhập *</label>
                <input 
                    type="text" 
                    id="id_username" 
                    name="username"
                    placeholder="nguyen_van_a"
                    required
                    value="{{ request.POST.username|default:'' }}"
                >
                <div class="help-text">Chỉ bao gồm chữ cái, số và dấu gạch dưới</div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="id_password1">Mật khẩu *</label>
                    <input 
                        type="password" 
                        id="id_password1" 
                        name="password1"
                        placeholder="••••••••"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="id_password2">Xác nhận mật khẩu *</label>
                    <input 
                        type="password" 
                        id="id_password2" 
                        name="password2"
                        placeholder="••••••••"
                        required
                    >
                </div>
            </div>

            <div class="help-text" style="margin-bottom: 15px;">
                Mật khẩu phải có ít nhất 8 ký tự
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label style="display: flex; align-items: flex-start; gap: 10px; margin-bottom: 0; font-weight: normal;">
                    <input type="checkbox" required style="width: auto; margin-top: 3px;">
                    <span>Tôi đồng ý với <a href="#" style="color: var(--primary-color);">Điều khoản dịch vụ</a> và <a href="#" style="color: var(--primary-color);">Chính sách bảo mật</a></span>
                </label>
            </div>

            <button type="submit" class="btn-submit">Tạo tài khoản</button>
        </form>

        <div class="auth-footer">
            <p>Đã có tài khoản? <a href="{% url 'accounts:login' %}">Đăng nhập</a></p>
        </div>
    </div>
</div>

<script>
    const roleInputs = document.querySelectorAll('input[name="role"]');
    const form = document.querySelector('form');
    
    form.addEventListener('submit', function(e) {
        const roleSelected = Array.from(roleInputs).some(input => input.checked);
        if (!roleSelected) {
            e.preventDefault();
            document.querySelector('.role-required').style.display = 'block';
            document.querySelector('.role-selection').style.borderColor = '#dc3545';
        }
    });

    roleInputs.forEach(input => {
        input.addEventListener('change', function() {
            document.querySelector('.role-required').style.display = 'none';
        });
    });
</script>
{% endblock %}